{{>header_autogen}}

unit {{classname}}.Rest;

interface

uses
  System.SysUtils,
  uRestCommandHandler,
  uHTTPClient,
  uRestRequest,
  {{classname}}Interface;

type
{{#operations}}
  T{{classname}}Rest = class 
  private
    FApi: I{{classname}};
  public
    {{#operation}}
    /// Operation {{{operationId}}}
    /// <summary>{{{summary}}}</summary>{{#remarks}}
    /// <remarks>{{.}}</remarks>{{/remarks}} 
    {{#allParams}}   
    /// {{paramName}}: {{description}} {{#required}}(required){{/required}}{{^required}}(optional{{#defaultValue}}, default to {{{.}}}{{/defaultValue}}){{/required}}{{#isDeprecated}} (deprecated){{/isDeprecated}}
    {{/allParams}}   
    procedure {{operationId}}(ARequest: TRestRequest; var AResult: THTTPResult){{#isDeprecated}} @deprecated{{/isDeprecated}};
    
    {{/operation}}
    
    constructor Create();
  end;

implementation

uses
  whizaxe.serialization,
  {{classname}}{{#imports}}{{#-first}},{{/-first}}
  {{{import}}}{{^-last}},{{/-last}}{{/imports}};
  
{ T{{classname}} }

constructor T{{classname}}Rest.Create;
begin
  FAPi := T{{classname}}.Create;
end;

{{#operation}}
procedure T{{classname}}Rest.{{operationId}}(ARequest: TRestRequest; var AResult: THTTPResult);
var
  {{#returnType}}responseObj: {{.}};{{/returnType}}
{{#allParams}}
  {{paramName}}: {{dataType}};
{{/allParams}}


begin
{{#pathParams}}
  {{paramName}} := ARequest.GetPathParam<{{dataType}}>('{{paramName}}', '{{defaultValue}}', {{required}});
{{/pathParams}}
{{#bodyParam}}
  {{paramName}} := ARequest.GetBodyParam<{{dataType}}>({{required}});
{{/bodyParam}}
{{#queryParams}}
  {{paramName}} := ARequest.GetQueryParam<{{dataType}}>('{{paramName}}', '{{defaultValue}}', {{required}});
{{/queryParams}}
{{#headerParams}}
  {{paramName}} := ARequest.GetHeaderParam<{{dataType}}>('{{paramName}}', '{{defaultValue}}', {{required}});
{{/headerParams}}
{{#returnType}}
  responseObj := FApi.{{operationId}}({{#allParams}}{{paramName}}{{^-last}}, {{/-last}}{{/allParams}});
{{/returnType}}
{{^returnType}}
  FApi.{{operationId}}({{#allParams}}{{paramName}}{{^-last}}, {{/-last}}{{/allParams}});
{{/returnType}}
 // AResult.SendResponse(responseObj);
end;

{{/operation}}

  
{{/operations}}
end.
